{% extends 'base.html' %}

{% block title %}履歴詳細 | ToolKeeper{% endblock %}

{% block active_asset_list %}active{% endblock %}

{% block contents %}
<section class="py-5">
    <div class="container px-4 px-lg-5 mt-3">
        <div class="text-center mb-3">
            <h2>履歴詳細</h2>
        </div>

        <div class="container my-5">
            <hr>
            <div class="row d-none d-lg-flex">
                <div class="col-8">
                    <strong>写真</strong>
                </div>
                <div class="col">
                    <div class="mb-3"><strong>アイテム一覧/詳細結果</strong></div>
                </div>
            </div>

            <div class="row">
                <div class="col-12 col-lg-8">
                    <span class="d-block d-lg-none mb-3"><strong>写真</strong></span>
                    <img src="{{ image.image.url }}" width="100%"/>
                    <span class="d-block d-lg-none mt-4 mb-3"><hr><strong>アイテム一覧/詳細結果</strong></span>
                </div>

                <div class="col-12 col-lg position-relative ps-4 ps-lg-0" id="check_list">
                    <ol class="row row-cols-1 row-cols-md-2 row-cols-lg-1 align-items-start d-lg-block w-100 mb-0 ps-5 my-position-lg-absolute" style="overflow: auto;">
                        {% for result in history.result_set.all %}
                            {% if result.result_class != 9 %}
                            <li class="col mb-2 ps-1 pe-3 pe-sm-4 pe-lg-0">
                                <div class="row row-cols-2 mx-auto pe-2 pe-xl-4">
                                    <span class="col w-auto me-auto ps-0">{{ result.item.item_name }}</span>
                                    <span class="col-auto me-sm-0 ps-0">：
                                        {% if result.result_class == 0 %}
                                            <u><font color="#ff6347">無し</font></u>
                                        {% elif result.result_class == 1 or result.result_class == 2 %}
                                            <u><font color="#99CC33">有り</font></u>
                                        {% else %}
                                            {{ result.result_class }}
                                        {% endif %}
                                    </span>
                                </div>
                            </li>
                            {% endif %}
                        {% empty %}
                            <p>履歴が存在しません</p>
                        {% endfor %}
                    </ol>
                </div>

            </div>

            <hr>

            <div class="row">
                <div class="col-3 col-lg-2">
                    <strong>グループ</strong>
                </div>
                <div class="col-9 col-lg-10">
                    {{ history.group.group_name }}
                </div>
            </div>
            
            <hr>

            <div class="row">
                <div class="col-3 col-lg-2">
                    <strong>ユーザー</strong>
                </div>
                <div class="col-9 col-lg-10">
                    {{ history.user.username }}
                </div>
            </div>
            
            <hr>

            <div class="row">
                <div class="col-3 col-lg-2">
                    <strong>管理名</strong>
                </div>
                <div class="col-9 col-lg-10">
                    {{ history.asset.asset_name }}
                </div>
            </div>
            
            <hr>

            <div class="row">
                <div class="col-3 col-lg-2">
                    <strong>確認日時</strong>
                </div> <div class="col-9 col-lg-10">
                    {{ history.checked_at }}
                </div>
            </div>
            
            <hr>
            
            <!-- <div class="row">
                <div class="col-3">
                    <strong>更新日時</strong>
                </div>
                <div class="col-9">
                    {{ history.updated_at }}
                </div>
            </div>
            <hr> -->

            <a class="btn btn-3 float-right" href="{% url 'toolkeeper_app:history_list' %}">履歴一覧に戻る</a>
            {% if history in abnormal_history_list %}
                <a class="btn btn-3 float-right" href="{% url 'toolkeeper_app:asset_detail' history.asset.id %}">管理項目詳細へ</a>
            {% endif %}
        </div>
    </div>
</section>

{% endblock %}


